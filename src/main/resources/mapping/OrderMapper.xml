<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cnh.dao.OrderMapper" >
  <resultMap id="BaseResultMap" type="com.cnh.dataobject.Orders" >
    <result column="id" property="id" jdbcType="INTEGER" />
    <result column="phone_id" property="phoneId"  jdbcType="INTEGER"/>
    <result column="user_id" property="userId" jdbcType="INTEGER"/>
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="comment" property="comment" jdbcType="VARCHAR" />
    <result column="release_id" property="releaseId" jdbcType="INTEGER" />
  </resultMap>


  <resultMap id="BaseResultMap1" type="com.cnh.dataobject.OrderUserPhone" >
    <result column="id" property="id" jdbcType="VARCHAR" />
    <result column="nickname" property="nickname"  jdbcType="VARCHAR"/>
    <result column="userId" property="userId" jdbcType="VARCHAR"/>
    <result column="orderStstus" property="orderStstus" jdbcType="VARCHAR" />
    <result column="comment" property="comments" jdbcType="VARCHAR" />
    <result column="phonename" property="phonename"  jdbcType="VARCHAR"/>
    <result column="imgUrl" property="imgUrl" jdbcType="VARCHAR"/>
    <result column="price" property="price" jdbcType="VARCHAR" />
    <result column="phoneStatus" property="phoneStatus" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR"/>
    <result column="store" property="store" jdbcType="VARCHAR" />
    <result column="cont" property="cont" jdbcType="VARCHAR" />
    <result column="releaseId" property="releaseId" jdbcType="VARCHAR" />
  </resultMap>
  <insert id="insert" parameterType="com.cnh.dataobject.Orders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Apr 14 23:40:33 CST 2020.
    -->
    insert into orders (id, phone_id, user_id,
      status,comment)
    values (#{id,jdbcType=INTEGER}, #{phoneId,jdbcType=INTEGER}, #{userId,jdbcType=INTEGER},
      #{status,jdbcType=VARCHAR}, #{comment,jdbcType=VARCHAR}, #{releaseId,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.cnh.dataobject.Orders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Apr 14 23:40:33 CST 2020.
    -->
    insert into orders
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="phoneId != null" >
        phone_id,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="status != null" >
      status,
    </if>
      <if test="comment != null" >
      comment,
    </if>
      <if test="releaseId != null" >
        release_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="phoneId != null" >
        #{phoneId,jdbcType=INTEGER},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="comment != null" >
        #{comment,jdbcType=VARCHAR},
      </if>
      <if test="releaseId != null" >
        #{releaseId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="update" parameterType="com.cnh.dataobject.Orders">

    update orders set
    <if test="id != null" >
      #{id,jdbcType=INTEGER},
    </if>
    <if test="phoneId != null" >
      #{phoneId,jdbcType=INTEGER},
    </if>
    <if test="userId != null" >
      #{userId,jdbcType=INTEGER},
    </if>
    <if test="status != null" >
      #{status,jdbcType=VARCHAR},
    </if>
    <if test="comment != null" >
      #{comment,jdbcType=VARCHAR},
    </if>
    <if test="releaseId != null" >
      #{releaseId,jdbcType=INTEGER},
    </if>
    where id =#{id}
  </update>
  <delete id="delete" parameterType="int">
      delete from orders where id = #{id}
    </delete>
  <select id="findById" resultType="com.cnh.dataobject.OrderUserPhone">
    SELECT u.nickname nickname,a.id id,a.phone_id phoneId,a.user_id userId,a.status orderStstus,a.comment comments,a.release_id releaseId,b.phone_name phonename,b.img_url imgUrl,b.price price,b.status phoneStatus,b.types type, b.store store,b.cont cont FROM `orders` a LEFT JOIN phone b   on a.phone_id=b.id  LEFT JOIN `user` u      on  a.user_id = u.id where a.id=#{id}
  </select>
  <select id="findAll" resultMap="BaseResultMap1">
  SELECT u.nickname nickname,a.id id,a.phone_id phoneId,a.user_id userId,a.status orderStstus,a.comment comments,a.release_id releaseId,b.phone_name phonename,b.img_url imgUrl,b.price price,b.status phoneStatus,b.types type, b.store store,b.cont cont FROM `orders` a LEFT JOIN phone b   on a.phone_id=b.id  LEFT JOIN `user` u      on  a.user_id = u.id
  </select>
  <select id="findAllByStatus" resultMap="BaseResultMap1">
   SELECT u.nickname nickname,a.id id,a.phone_id phoneId,a.user_id userId,a.status orderStstus,a.comment comments,a.release_id releaseId,b.phone_name phonename,b.img_url imgUrl,b.price price,b.status phoneStatus,b.types type, b.store store,b.cont cont FROM `orders` a LEFT JOIN phone b   on a.phone_id=b.id  LEFT JOIN `user` u      on  a.user_id = u.id        where a.status=#{status}

  </select>
  <select id="findByUserIdAndStatus" resultMap="BaseResultMap1">
    SELECT u.nickname nickname,a.id id,a.phone_id phoneId,a.user_id userId,a.status orderStstus,a.comment comments,a.release_id releaseId, b.phone_name phonename,b.img_url imgUrl,b.price price,b.status phoneStatus,b.types type, b.store store,b.cont cont FROM `orders` a LEFT JOIN phone b   on a.phone_id=b.id  LEFT JOIN `user` u      on  a.user_id = u.id
   <where>
    <if test="status != null">
      b.status=#{status}
   </if>
     <if test="userId != null">
    and  a.user_id =#{userId}
     </if>
   </where>
  </select>
    <select id="findByPhoneId" resultType="com.cnh.dataobject.Orders">
 select * from orders where phone_id = #{phoneId}    </select>
  <select id="findByUserIdPhone" resultType="com.cnh.dataobject.OrderUserPhone">
         SELECT u.nickname nickname,a.id id,a.phone_id phoneId,a.user_id userId,a.status orderStstus,a.comment comments,b.phone_name phonename,b.img_url imgUrl,b.price price,b.status phoneStatus,b.types type, b.store store,b.cont cont FROM `orders` a LEFT JOIN phone b   on a.phone_id=b.id  LEFT JOIN `user` u      on  a.user_id = u.id        where a.release_id=#{userId}
  </select>
  <select id="findById2" resultType="com.cnh.dataobject.Orders">
     select * from orders where id = #{id}
  </select>
</mapper>